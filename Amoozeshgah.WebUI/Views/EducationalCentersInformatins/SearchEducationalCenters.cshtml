@model Amoozeshgah.ViewModel.SearchEducationalCenterDto
    @{
        Layout = null;
    }

    <!DOCTYPE html>

    <html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <title>جستجوی مراکز آموزشی</title>
        <link href="~/wwwroot/Content/bootstrap.rtl.min.css" rel="stylesheet" />
        <link href="~/wwwroot/Content/vazir-font.css" rel="stylesheet" />
        <link href="~/wwwroot/bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
        <link href="~/wwwroot/bower_components/data-tables/datatables.min.css" rel="stylesheet" />
        <link href="~/wwwroot/bower_components/data-tables/DataTables-1.10.16/css/dataTables.bootstrap.css" rel="stylesheet" />

        <link href="~/wwwroot/Content/sb-admin-2.css" rel="stylesheet" />
        <style>
            body {
                font-family: Vazir;
            }

            .form-horizontal .control-label {
                text-align: right;
            }

            .adineh {
                margin-top: 22px;
            }
        </style>
    </head>
    <body>
        <center><img class="img-responsive" src="~/wwwroot/images/educational-centers-information-title.png" /></center>
        @using (Html.BeginForm("SearchEducationalCenters", "EducationalCentersInformatins", FormMethod.Post, new { onsubmit = "return SearchEducationalCenters(this)" }))
        {
            <div class="container">
                <div class="row">
                    <div class="panel panel-primary">
                        <div class="panel-heading"><i style="cursor: pointer" class="fa fa-fw fa-sort" data-toggle="collapse" data-target=".demo"></i> جستجوی مرکز آموزشی</div>
                        <div class="panel-body demo collapse in">
                            <div class="form-horizontal">
                                <div class="form-group col-md-4 col-sm-6 col-xs-12">
                                    @Html.LabelFor(m => m.ProvinceId, new { @class = "control-label col-xs-12" })
                                    <div class="col-xs-12">
                                        @Html.DropDownListFor(m => m.ProvinceId, Model.Provinces, "انتخاب کنید", new { @class = "form-control" })
                                        &nbsp; @Html.ValidationMessageFor(m => m.ProvinceId, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="form-group col-md-4 col-sm-6 col-xs-12">
                                    @Html.LabelFor(m => m.AreaId, new { @class = "control-label col-xs-12" })
                                    <div class="col-xs-12">
                                        @Html.DropDownListFor(m => m.AreaId, Model.Areas, "انتخاب کنید", new { @class = "form-control" })
                                        &nbsp; @Html.ValidationMessageFor(m => m.AreaId, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="form-group col-md-4 col-sm-6 col-xs-12">
                                    @Html.LabelFor(m => m.SexId, new { @class = "control-label col-xs-12" })
                                    <div class="col-xs-12">
                                        @Html.DropDownListFor(m => m.SexId, Model.Sexes, "انتخاب کنید", new { @class = "form-control" })
                                        &nbsp; @Html.ValidationMessageFor(m => m.SexId, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="form-group col-md-4 col-sm-6 col-xs-12">
                                    @Html.LabelFor(m => m.EducationalCenterCategory, new { @class = "control-label col-xs-12" })
                                    <div class="col-xs-12">
                                        @Html.DropDownListFor(m => m.EducationalCenterCategory, Model.EducationalCenterCategories, "انتخاب کنید", new { @class = "form-control" })
                                        &nbsp; @Html.ValidationMessageFor(m => m.EducationalCenterCategory, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="form-group col-md-4 col-sm-6 col-xs-12">
                                    @Html.LabelFor(m => m.EducationalCenterName, new { @class = "control-label col-xs-12" })
                                    <div class="col-xs-12">
                                        @Html.TextBoxFor(m => m.EducationalCenterName, new { @class = "form-control" })
                                        &nbsp; @Html.ValidationMessageFor(m => m.EducationalCenterName, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="form-group col-md-4 col-sm-6 col-xs-12">
                                    @Html.LabelFor(m => m.EducationalCenterCode, new { @class = "control-label col-xs-12" })
                                    <div class="col-xs-12">
                                        @Html.TextBoxFor(m => m.EducationalCenterCode, new { @class = "form-control", type = "number" })
                                        &nbsp; @Html.ValidationMessageFor(m => m.EducationalCenterCode, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer demo collapse in">
                            <center>
                                <button class="btn btn-info btn-outline"><i class="fa fa-fw fa-search"></i>جستجو</button>
                            </center>
                        </div>
                    </div>
                    <hr />
                    <div class="panel panel-primary">
                        <div class="panel-heading"><i style="cursor: pointer" class="fa fa-fw fa-sort" data-toggle="collapse" data-target=".demo2"></i> نتیجه</div>
                        <div class="panel-body demo2 collapse in">
                            <table class="table datatable display table-responsive table-hover table-striped">
                                <thead>
                                    <tr>
                                        <th>نام مرکز</th>
                                        <th>کد مرکز</th>
                                        <th>استان</th>
                                        <th>ناحیه</th>
                                        <th>نوع</th>
                                        <th>جنسیت</th>
                                        <th></th>

                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>

                    </div>






                </div>
            </div>


            <div id="myModal" class="modal fade">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <!-- dialog body -->
                        <div class="modal-body">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <span id="myModalbody"></span>
                        </div>
                    </div>
                </div>
            </div>


        }


        <script src="~/wwwroot/bower_components/jquery/dist/jquery-1.10.2.min.js"></script>


        <script src="~/wwwroot/bower_components/data-tables/datatables.min.js"></script>
        <script src="~/wwwroot/Scripts/jquery.validate.min.js"></script>
        <script src="~/wwwroot/Scripts/jquery.validate.unobtrusive.min.js"></script>
        <script src="~/wwwroot/Scripts/bootstrap.rtl.min.js"></script>


        <script>

            var t = $('.datatable').DataTable({
                language: {
                    url: "//cdn.datatables.net/plug-ins/1.10.16/i18n/Persian.json"
                }
            });

            function SearchEducationalCenters(form) {

                $.validator.unobtrusive.parse(form);
                if ($(form).valid()) {
                    $.ajax({
                        type: "POST",
                        url: form.action,
                        data: $(form).serialize(),
                        success: function (data) {
                            t.clear().draw();
                            $(data).each(function () {
                                t.row.add([
                                    this.EducationalCenterName,
                                    this.EducationalCenterCode,
                                    this.Province,
                                    this.Area,
                                    this.Category,
                                    this.Sex,
                                    `<a href="#" class="btn  btn-success btn-sm"  onclick="return EducationalCenterDetail(${this.EducationalCenterCode})">جزئیات</a>`
                                ]).draw(false);
                            });

                        }
                    });
                }


                return false;
            }
            function EducationalCenterDetail(educationalCenterCode) {


                if (educationalCenterCode > 0) {
                    $.ajax({
                        type: 'Post',
                        datatype: "json",
                        url: '/EducationalCentersInformatins/AjaxEducationalCenterDetails/',
                        data: { educationalCenterCode: educationalCenterCode },
                        success: function (detail) {
                            $("#myModalbody").html(detail);
                            $('#myModal').modal('show');
                        },
                        error: function (e) {
                            alert("error");
                        }
                    });
                }
                return false;
            }

        </script>

        <script>
            $(document).ready(function ($) {
                $("#ProvinceId").on('change',
                    function () {

                        var provinceId = $(this).val();
                        if (provinceId) {
                            $.ajax({
                                type: 'Post',
                                datatype: "json",
                                url: '/ChooseCourses/AjaxProvinceAreas/',
                                data: { provinceId: provinceId },
                                success: function (areas) {

                                    $('#AreaId').empty();
                                    $('#AreaId').append('<option selected>انتخاب کنید</option>');
                                    $('#AreaId').append('<option value="0">همه ناحیه ها</option>');
                                    $(areas).each(function () {

                                        var value = this.Id;
                                        var text = this.Text;
                                        $('#AreaId').append('<option value=' + value + '>' + text + '</option>');
                                    });

                                },
                                error: function (e) {
                                    alert("error");
                                }
                            });
                        } else {
                            $('#AreaId').remove('option');
                        }
                    });
            });
        </script>
    </body>
</html>
